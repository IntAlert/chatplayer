webpackJsonp([4],{"./app/containers/HomePage/constants.js":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"i",function(){return i}),n.d(t,"g",function(){return p}),n.d(t,"h",function(){return f});var r="app/Home/SCRIPT_FETCH_REQUESTED",o="app/Home/SCRIPT_FETCH_SUCCEEDED",s="app/Home/SCRIPT_FETCH_FAILED",a="borderbot/Home/RESPOND",c="app/Home/TIMER_START",u="app/Home/TIMER_TICK",i="app/Home/BOT_MESSAGE_INVISIBLE",p="app/Home/BOT_MESSAGE_WRITING",f="app/Home/BOT_MESSAGE_VISIBLE"},"./app/containers/HomePage/reducer.js":function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments[1],n=function(){switch(t.type){case u.d:var n=e.merge({script_loaded:!0,script:t.script,current_stage_id:t.script.setup.initial_stage_id,scores:t.script.setup.initial_scores});return n=s(n,t.script.setup.initial_stage_id),{v:n};case u.e:return console.log("script fetch failed"),{v:e};case u.f:var r=e.getIn(["script","stages",t.stage_id,"choices",t.choice_id]),c=r.getIn(["next_stage_id"]);return n=e.set("current_stage_id",c).set("show_user_choices",!1).update("feed",function(e){return e.push({speaker:0,type:"text",content:r.get("text")})}),n=o(n,r),n=s(n,c),{v:n};case u.c:var p=e.get("feed").findIndex(function(e){return(e.speaker==-1||1==e.speaker)&&e.status==u.g});if(p>-1){var f=function(){var t=e.updateIn(["feed",p],function(e){var t=Object.assign({},e);return t.status=u.h,t}),n=e.getIn(["feed",p]).scoreChange;return n&&(t=t.updateIn(["scores"],function(e){return a(n,e)})),{v:{v:t}}}();if("object"===("undefined"==typeof f?"undefined":i(f)))return f.v}var d=e.get("feed").findIndex(function(e){return(e.speaker==-1||1==e.speaker)&&e.status==u.i});return d>-1?{v:e.updateIn(["feed",d],function(e){var t=Object.assign({},e);return t.status=u.g,t})}:0==e.get("show_user_choices")&&e.get("current_stage_id")!==!1?{v:e.set("show_user_choices",!0)}:{v:e};default:return{v:e}}}();if("object"===("undefined"==typeof n?"undefined":i(n)))return n.v}function o(e,t){var n=t.getIn(["responses"]);if(void 0==n)return console.log("// no immediate responses"),e;var r=e.update("feed",function(e){var t=e;return n.toArray().forEach(function(e){var n={speaker:1,status:u.i,type:e.get("type"),content:e.get("content"),scoreChange:e.get("scoreChange")};t=t.push(n)}),t});return r}function s(e,t){var n=e.getIn(["script","stages",t,"prompts"]),r=e.update("feed",function(e){var t=e;return n.toArray().forEach(function(e){var n={speaker:-1,status:u.i,type:e.get("type"),content:e.get("content"),scoreChange:e.get("scoreChange")};t=t.push(n)}),t});return r}function a(e,t){var r=Object.assign({},t.toJS()),o=e.toJS();console.log(o);for(var s in o){var a=o[s];switch(a.operator){case"multiply":r[s]=Math.ceil(r[s]*a.amount);break;case"add":r[s]+=a.amount;break;case"set":r[s]=a.amount;break;default:throw"Unknown change operator "+a.operator}}return n.i(c.fromJS)(r)}Object.defineProperty(t,"__esModule",{value:!0});var c=n("./node_modules/immutable/dist/immutable.js"),u=(n.n(c),n("./app/containers/HomePage/constants.js")),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=n.i(c.fromJS)({script_loaded:!1,current_stage_id:!1,show_user_choices:!1,script:{},feed:[],scores:{}});t.default=r}});