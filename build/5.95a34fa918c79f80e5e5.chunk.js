webpackJsonp([5],{"./app/containers/HomePage/constants.js":function(a,b,c){"use strict";c.d(b,"a",function(){return d}),c.d(b,"e",function(){return e}),c.d(b,"f",function(){return f}),c.d(b,"g",function(){return g}),c.d(b,"b",function(){return h}),c.d(b,"c",function(){return i}),c.d(b,"d",function(){return j}),c.d(b,"j",function(){return k}),c.d(b,"h",function(){return l}),c.d(b,"i",function(){return m});var d="app/Home/SCRIPT_FETCH_REQUESTED",e="app/Home/SCRIPT_FETCH_SUCCEEDED",f="app/Home/SCRIPT_FETCH_FAILED",g="borderbot/Home/RESPOND",h="app/Home/TIMER_START",i="app/Home/TIMER_TICK",j="app/Home/PRINT",k="app/Home/BOT_MESSAGE_INVISIBLE",l="app/Home/BOT_MESSAGE_WRITING",m="app/Home/BOT_MESSAGE_VISIBLE"},"./app/containers/HomePage/reducer.js":function(a,b,c){"use strict";function d(a,b){var c=b.getIn(["responses"]);if(void 0==c)return console.log("// no immediate responses"),a;var d=a.update("feed",function(a){var b=a;return c.toArray().forEach(function(a){var c={speaker:1,status:i.j,type:a.get("type"),content:a.get("content"),more:a.get("more"),scoreChange:a.get("scoreChange")};b=b.push(c)}),b});return d}function e(a,b){var c=a.getIn(["script","stages",b,"prompts"]),d=a.update("feed",function(a){var b=a;return c.toArray().forEach(function(a){var c={speaker:-1,status:i.j,type:a.get("type"),content:a.get("content"),more:a.get("more"),scoreChange:a.get("scoreChange")};b=b.push(c),a.get("more")&&(console.log("***"+c.more),console.log(b.toJS()))}),b});return d}function f(a,b){var d=Object.assign({},b.toJS()),e=a.toJS();for(var f in e){var h=e[f];switch(h.operator){case"multiply":d[f]=Math.ceil(d[f]*h.amount);break;case"add":d[f]+=h.amount;break;case"set":d[f]=h.amount;break;default:throw"Unknown change operator "+h.operator;}}return c.i(g.fromJS)(d)}Object.defineProperty(b,"__esModule",{value:!0});var g=c("./node_modules/immutable/dist/immutable.js"),h=c.n(g),i=c("./app/containers/HomePage/constants.js"),j=c.i(g.fromJS)({script_loaded:!1,current_stage_id:!1,show_user_choices:!1,script:{},feed:[],scores:{}});b["default"]=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:j,b=arguments[1];switch(b.type){case i.e:var c=a.merge({script_loaded:!0,script:b.script,current_stage_id:b.script.setup.initial_stage_id,scores:b.script.setup.initial_scores});return c=e(c,b.script.setup.initial_stage_id),c;case i.f:return console.log("script fetch failed"),a;case i.g:var g=a.getIn(["script","stages",b.stage_id,"choices",b.choice_id]);if("route"===g.getIn(["targetType"]))return window.location.href=g.getIn(["target"]),a;var h=g.getIn(["target"]),c=a.set("current_stage_id",h).set("show_user_choices",!1).update("feed",function(a){return a.push({speaker:0,type:"text",content:g.get("text")})});return c=d(c,g),c=e(c,h),c;case i.c:var k=a.get("feed").findIndex(function(a){return(-1==a.speaker||1==a.speaker)&&a.status==i.h});if(-1<k){var l=a.updateIn(["feed",k],function(a){var b=Object.assign({},a);return b.status=i.i,b}),m=a.getIn(["feed",k]).scoreChange;return m&&(l=l.updateIn(["scores"],function(a){return f(m,a)})),l}var n=a.get("feed").findIndex(function(a){return(-1==a.speaker||1==a.speaker)&&a.status==i.j});return-1<n?a.updateIn(["feed",n],function(a){var b=Object.assign({},a);return b.status=i.h,b}):!1==a.get("show_user_choices")&&!1!==a.get("current_stage_id")?a.set("show_user_choices",!0):a;case i.d:window.print();break;default:return a;}}}});